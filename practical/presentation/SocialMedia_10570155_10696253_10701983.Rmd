---
title: "MATH 513 Practical Presentation"
author: "10570155, 10696253, 10701983"
date: "10/12/2020"
output: 
  beamer_presentation: 
    theme: Boadilla
    colortheme: beaver
---

<!-- 

OVERVIEW

  Speaker notes are kept in comments to hide from presentation unless the comment is in a code chunck
  Code requires you to have the csv data set that is available from the following GitHub repository: https://github.com/Mauzey/MATH513-Group-Work

-->

```{r Initial Setup, include=FALSE}

knitr::opts_chunk$set(include = FALSE)

# IMPORT DEPENDENCIES -------------------------------------------------------------------------------------------------------
libs <- c('readr', 'dplyr', 'tidyverse', 'tidyr', 'tidytext', 'modelr', 'stringr', 'rtweet','knitr', 'ggplot2', 'ggthemes',
          'scales', 'knitr')
invisible(lapply(libs, library, character.only = TRUE))

# SET WORKING DIRECTORY -----------------------------------------------------------------------------------------------------
#setwd("C:/Users/willo/SynologyDrive/Documents - Will/Qualifications/!MSc Data Science/!Courses/1 MATH513 Big Data and Social Network/Assessment/MATH513-Group-Work/practical") # Will
#setwd("") # Tania
#setwd("~/Development/Repositories/MATH513-Group-Work/practical") # Alex

# IMPORT DATA ---------------------------------------------------------------------------------------------------------------
tweets <- read_csv("../data/cleaned-tweets.csv") #Load in tweets from the csv file.
users <- read_csv("../data/cleaned-users.csv")
```

<!-- 

PRESETNATION CHECKLIST

/ = complete and in presentation

/Two contrasting business related topics
  - /Apple and Samsung Intro

/social media source such as Twitter
  - /rtweet and twitter api
  - holistic view using other sources ###### NEED THIS

Range of suitable data visualization techniques
  - /Box Plot
  - /Time Series
  - /Location Map
  - /Pie Chart of Tweets - % Spam VS General VS usable feature tweets per product, normalised for easy comparison ################### NEED THIS
  - Data Frame (Tweet count) ######################### NEED THIS

/appropriate sentiment analysis
  - /sentiment by feature by product (mean/avg sentiment)
  
 
Statistical Test
  Stock price VS sentiment on a daily basis ############### NEED THIS
  Is a T-Test appropriate?  ################## NEED THIS


Manipulation techniques used and why ##### ALEX FILLING IN
    Remove hyperlinks, emojis, user mentions and hashtags
    Adding additional columns for filtering data correctly
Graphs and why

strategic business impact (Apple, Samsung)
marketing interest (Apple, Samsung)

--->



<!--- Slide 01 ------------------------------------------------------------------------------------------------------------->

## Introduction

<!--- SPEAKER NOTES:

  ...

--->

- Samsung and Apple <!-- Chosen as competing businesses due to the current releases of their flagship phones meaning data would be available. --->
- Flagship phones chosen
  + S20FE
  + iPhone12
  + S20 <!-- We chose to gather some tweets on the S20 to give us some comparable information for sentiment analysis. This allowed us to show the usefulness of the analysis process and outcomes as Samsung had supposedly listened to its fan base when developing the S20 Fan Edition. --->

**Tools Utilised**

- Rstudio
- RTweet
- Twitter Developer API <!--- Allowed us access to the twitter data to analyse --->
- Github <!-- To allow us to work on various parts of the project and keep an up to date record of changes as a team --->

```{r Logos, echo=FALSE, out.width="15%", fig.align = "center", fig.show='hold', fig.cap=""}
knitr::include_graphics(c("./Images/Logos/apple_logo.png", "./Images/Logos/samsung_logo.jpg", "./Images/Logos/rstudio_logo.png",     "./Images/Logos/twitter_logo.png"))
```

<!--- End of Slide 01 ------------------------------------------------------------------------------------------------------>






<!--- Slide 02 ------------------------------------------------------------------------------------------------------------->

## Research

<!--- SPEAKER NOTES:

  ...

--->


**Chosing Twitter for Analysis**

  !!! Why did we choose Twitter data ## Ref needed

- Twitter data provides up to date information for companies to analyse for customer feedback
- Data can provide useful information to guide product teams when analysed correctly

  <!-- Need to reference the Twitter accounts that we used to determine the #hashtags that we chose --->


**Hashtags**
- @SamsungMobile - https://twitter.com/SamsungMobile <!-- From the Samsung Mobile page we identified that the hastags #GalaxyS20 and #GalaxyS20FE were the offical hashtags used by Samsung in their Twitter posts
- @Apple - https://twitter.com/Apple <!-- We then looked for the same information from Apple but found that since the Twitter account was hacked on the 15th July 2020, Apple have not been keeping tweets on their Twitter page. (Swider, Matt (2020), TechRadar - https://www.techradar.com/news/twitter-hack-2020)  -->
- @tim_cook - https://twitter.com/tim_cook <!-- We then looked to the CEO of Apple as it was deemed most likely that he would be using the offical hashtags as deemed by Apple's marketing team, which led us to the hashatg #iphone12. -->

<!-- We also did some sample searches of other hashtags like S20 and S20FE using the advanced Twitter search on the website to determine how relevant the hashtag was. We did this simply by examining after how spread the dates were from the first 25 tweets. This research further supported our findings on the iphone12, samsungs20 and samungs20fe hashtags. -->
<!-- We came to the conclusion that it was better to use hashtags over actual profiles, both business or individual, so that we would get a wide range of opions for a fairer analysis. -->


!!! Pictures of the phones in colours that match graphs to associate?

<!--- End of Slide 02 ------------------------------------------------------------------------------------------------------>






<!--- Slide 03 ------------------------------------------------------------------------------------------------------------->

## Data Cleaning and Feature Engineering

<!--- SPEAKER NOTES:

  - We removed duplicate entries for both the tweet and user data
  
  - The tweet text and user bios were stripped of:
    - Links
    - Hash-tags
    - Emojis
    - User mentions
    
  - We marked users as bots depending on:
    - Whether the source of their tweets identified them as a bot, using keywords
    - Whether their user bio identified them as a bot, using keywords
    
  - User locations varied to the point where they couldn't be plotted:
    - We used the 'country code' package to identify the country of a user
  
  - We marked tweets as spam depending on:
    - Whether the tweet text identified it a spam, using keywords
    - Whether the author of the tweet was previously marked as a bot
  
  - We extracted the following product features from the tweet text:
    - Display, Camera, Battery, Price, and 5G Capability
  
  - We calculated a sentiment score for each tweet by:
    - Getting sentiment for each word in the tweet, and averaging the results

--->

**Data Cleaning**

- Duplicate tweet and user observations were removed
- Tweet text and user bios were cleaned

**Feature Engineering**

- Users were marked as potential bots
- User country was extracted from the location of their profile
- Tweets were marked as potential spam
- Product features were extracted from the tweet text
  + Display, Battery, Camera, Price, and 5G Capability
- An overall sentiment score was calculated for each tweet

<!--- End of Slide 03 ------------------------------------------------------------------------------------------------------>






<!--- Slide 04 ------------------------------------------------------------------------------------------------------------->

## Summary of Collected Data

<!--- SPEAKER NOTES:

  - We collected roughly 110,000 tweets
    - After data cleaning, we were left with roughly 74,000 tweets
  
  - We extracted 5 features from these tweets during feature engineering
  
  - Table 1 shows a summary of the tweet data:
  
    - There are less tweets for the Galaxy S20 than the S20 FE and iPhone 12
      - This is due to the constraints imposed by the Twitter API rate limits
      
    - 15-20% of the S20 FE and iPhone12 tweets are marked as spam, compared to the 3% for the S20
      - Perhaps due to spammers focusing on the newer, more relevant products to reach a wider audience
      
    - Only 7% of iPhone12 tweets contained mentions of the features, compared to roughly 20% for the S20 and S20 FE
  
  - Table 2 shows a summary of the user data:
  
    - There were 35,000 unique users, from 163 identified countries
      - XX% of users didn't have a valid country associated
    
    - Less than 1% of users were marked as bots (the actual number of identified bots is 155)
    
--->

```{r Overview of Data Extracted}
total_tweets <- nrow(tweets)

tweets_summary <- tweets %>%
  group_by(product) %>%  # Group by product
  summarise(n_tweets = length(status_id),  # Number of tweets
            percent_spam = percent(length(which(potential_spam == T))/n_tweets),  # % spam tweets
            percent_features = percent(length(which(!is.na(mentioned_features)))/n_tweets)  # % of tweets with mentioned features
  ) %>%
  rename('Product' = product, 'Number of Tweets' = n_tweets,
         '% Spam Tweets' = percent_spam,'% Feature Tweets' = percent_features)

users_summary <- users %>%
  summarise(n_users = length(user_id),  # Number of unique users
            percent_bots = '>1%',  # % of bot users (actual value = 0.00442)
            n_countries = length(unique(country))  # Number of unique countries
  ) %>%
  rename('Number of Users' = n_users, '% Bot Users' = percent_bots, 'Unique Countries' = n_countries)
```

**Total Tweets:** `r total_tweets` (after data cleaning)

**Total Features:** `5 (Display, Battery, Camera, Price, and 5G)`

`r kable(tweets_summary, caption = "Summary of Tweet Data")`

`r kable(users_summary, caption = "Summary of User Data")`

<!--- End of Slide 04 ------------------------------------------------------------------------------------------------------>






<!--- Slide 05 ------------------------------------------------------------------------------------------------------------->

## Results - Time Series

<!--- SPEAKER NOTES:

  Due to the limitations of the free version of the Twitter API we pulled as much data as we could over the last month. 
  The release date for the S20FE was the 2nd October 2020 and for the iPhone12 was the 23rd October 2020.
  This limitation meant that the tweets we pulled are about 3 weeks after the release date for the S20FE and 1 week after the iPhone release.
  From the graph, you can see that we managed to gather a reasonable amount of tweets over the month of November.

--->

```{r Time_Series_Plots, echo=FALSE}
tweets %>% 
  filter(product == 'Galaxy S20 FE' | product == 'iPhone12') %>%
  group_by(product, is_retweet) %>%
  ts_plot('days', trim = 1) + 
  theme_minimal() +
  facet_grid(product ~ .) +
  labs(x = NULL, y = NULL,
       title = "Frequency of Twitter Statuses",
       subtitle = "Twitter status counts aggregated using 1-day intervals by product",
       caption = "Source: Data collected from Twitter's REST API via rtweet") +
  theme(plot.title = element_text(face = 'bold'))
```

<!--- End of Slide 05 ------------------------------------------------------------------------------------------------------>







## Results - Sentiment Analysis

**Overview of sentiment analysis**


**Choice of feature to analyse**




## Results - Sentiment Analysis

GRAPH HERE




## Results - Sentiment Analysis

GRAPH HERE




## Improvements & Further Study

**Improvements**

Google Maps API to have region filter

Look at mentions of apple in samsung and vice versa




## Issues and overcoming them

- Extraction by date
- Duplication
- Time limits
- Foreign languages
- 


<!--
- Date refinement on Twitter Premium API functions only
  + Dev suite allowed limited access to full archive and 30 day extraction features
- Tweets are pulled from date to backwards to date to
  + Pull tweets in a controlled manner using weeks and days
- Possible duplication if we extracted at the same time
  + Full archive and 30 day extraction allowed for refinement of dates and pull tweets back to 2006
- Extraction limited to 18k per 15mins
  + Controlled pull of tweets with date refinement over time as retry on rate limit did not function a expected
- Foreign languages
  + Filter by language of 'en' applied to only pull English tweets

-->



## Conclusions

- Twitter data provides up to date information for companies to analyse for customer feedback

- Data can provide useful information to guide product teams when analysed correctly





## References

- Twitter (2020) *API Documentation* Available at: [https://developer.twitter.com/en/docs/twitter-api](https://developer.twitter.com/en/docs/twitter-api) (Accessed: 10 October 2020)

- RStudio (2020) *R Markdown Cheat Sheet* Available at: [https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf) (Accessed: 10 October 2020)

- RStudio (2014) *R Markdown Reference Guide* Available at: [https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf) (Accessed: 10 October 2020)

- Dalla Valle, Luciana (2020) *MATH513 Lecture and Tutorial Code* Available at: [https://dle.plymouth.ac.uk/course/view.php?id=49628](https://dle.plymouth.ac.uk/course/view.php?id=49628) (Accessed:  2020)

- Fuchs, Matti (2018) *Doing your first sentiment analysis in R with Sentimentr* Available at: [https://towardsdatascience.com/doing-your-first-sentiment-analysis-in-r-with-sentimentr-167855445132](https://towardsdatascience.com/doing-your-first-sentiment-analysis-in-r-with-sentimentr-167855445132) (Accessed: 06 December 2020)
  
- Rinker, Tyler (2020)  *R Documentation - sentiment_by* Available at:  [https://www.rdocumentation.org/packages/sentimentr/versions/2.7.1/topics/sentiment_by](https://www.rdocumentation.org/packages/sentimentr/versions/2.7.1/topics/sentiment_by) (Accessed: 06 December 2020)

```{r}

citation()

```

