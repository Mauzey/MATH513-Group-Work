---
title: "The Speechanalysis Package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{vignette_speechanalysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

|       **Authors**: 10570155, 10696253, 10701983
|       **Date**: 14th January 2021

```{r setup, include=FALSE}
libs <- c('speechanalysis', 'knitr')

invisible(lapply(libs, library, character.only = TRUE))
```

### Usage:
```{r usage, results=FALSE}
library(speechanalysis)
```

## Donald Trump Speech Data

The `speechanalysis` package comes with an example dataset. It consists of data detailing 10 speeches made by President Donald 
Trump throughout September 2020.

The dataset can be accessed like so:

```{r trump_speech_data}
trump_speeches
```

### Timing, location and election results

The speeches span from the 03/09/2020 to 22/09/2020 and take place in the following locations: 

| Date     | City          | State          | Length of Speech   | Election Result | Nearest Golf Course |
|----------|---------------|----------------|--------------------|-----------------|---------------------|
| 03/09/20 | Latrobe       | Pennsylvania   | 01:31:29 - 1.52hrs | Biden           | 2.2mi - 4mins       |
| 08/09/20 | Winston-Salem | North Carolina | 01:13:55 - 1.23hrs | Trump           | 3.1mi - 7mins       |
| 10/09/20 | Freeland      | Michigan       | 01:21:06 - 1.35hrs | Biden           | 4.7mi - 8mins       |
| 12/09/20 | Minden        | Nevada         | 01:32:01 - 1.53hrs | Biden           | 7.2mi - 13mins      |
| 13/09/20 | Henderson     | Nevada         | 01:06:44 - 1.11hrs | Biden           | 4.7mi - 11mins      |
| 17/09/20 | Mosinee       | Wisconsin      | 01:32:36 - 1.54hrs | Biden           | 0.9mi - 4mins       |
| 18/09/20 | Bemidji       | Minnesota      | 01:48:20 - 1.81hrs | Biden           | 7.5mi - 14mins      |
| 19/09/20 | Fayetteville  | North Carolina | 01:48:40 - 1.81hrs | Trump           | 9.1mi - 14mins      |
| 21/09/20 | Vandalia      | Ohio           | 01:05:53 - 1.10hrs | Trump           | 4.4mi - 11mins      |
| 22/09/20 | Pittsburgh    | Pennsylvania   | 01:29:51 - 1.50hrs | Biden           | 8.1mi - 10mins      |

Average legth of the speeches was 01:24:04 - 1.35hrs.

Average time to nearest golfcourse from the airport was 9.6 mins at a distance of 5.19 miles.

Of the 10 places in the dataset only 3 of them ended up being won by Trump in the 2020 America Presidential Election.

### Readability

The following table show the readability calculation of each of Trump's speeches. 

| Date       | City          | Flesch-Kincaid Reading (Higher is easier) | New Dale Chall (Lower is easier) | Spache Readability (Lower is easier) | Flesch-Kincaid Grade (Lower is easier) | Gunning Fog Index (Lower is easier) | Coleman-Liau Index (Lower is easier) | SMOG Index Score (Lower is easier) | Automated Readability Index (Lower is easier) |
|------------|---------------|:-----------------------------------------:|:--------------------------------:|:------------------------------------:|:--------------------------------------:|:-----------------------------------:|:------------------------------------:|:----------------------------------:|:---------------------------------------------:|
| 14/09/20 | Philadelphia  |                     70                    |                4.4               |                   5                  |                   6.5                  |                 8.5                 |                 10.4                 |                 10                 |                      5.5                      |
| 08/09/20   | Winston-Salem | 87.2                                      | 3.1                              | 5                                    | 3.4                                    | 6                                   | 6.7                                  | 8                                  | 1.1                                           |
| 10/09/20   | Freeland      | 82.5                                      | 3.5                              | 5                                    | 4.3                                    | 6.9                                 | 7.3                                  | 8.8                                | 2.2                                           |
| 12/09/20   | Minden        | 82.2                                      | 3.6                              | 5                                    | 4.2                                    | 6.7                                 | 7.7                                  | 8.6                                | 2.3                                           |
| 13/09/20   | Henderson     | 82.7                                      | 3.3                              | 5                                    | 4.3                                    | 6.8                                 | 7.4                                  | 8.6                                | 2.3                                           |
| 17/09/20   | Mosinee       | 83.8                                      | 3.4                              | 5                                    | 4                                      | 6.6                                 | 7.4                                  | 8.5                                | 2                                             |
| 18/09/20   | Bemidji       | 82.9                                      | 3.2                              | 5                                    | 4.5                                    | 7.4                                 | 7.2                                  | 8.9                                | 2.7                                           |
| 19/09/20   | Fayetteville  | 84.7                                      | 3.3                              | 5                                    | 3.7                                    | 6.3                                 | 7.2                                  | 8.3                                | 1.6                                           |
| 21/09/20   | Vandalia      | 85.5                                      | 3.1                              | 5                                    | 3.7                                    | 6.4                                 | 7.1                                  | 8.2                                | 1.7                                           |
| 22/09/20   | Pittsburgh    | 79.9                                      | 3.5                              | 5                                    | 5                                      | 7.7                                 | 7.6                                  | 9.2                                | 3.1                                           |

We can then compare this to an equivalent speech by Joe Biden seen below: 

| Date       | City         | Flesch-Kincaid Reading (Higher is easier) | New Dale Chall (Lower is easier) | Spache Readability (Lower is easier) | Flesch-Kincaid Grade (Lower is easier) | Gunning Fog Index (Lower is easier) | Coleman-Liau Index (Lower is easier) | SMOG Index Score (Lower is easier) | Automated Readability Index (Lower is easier) |
|------------|--------------|:-----------------------------------------:|:--------------------------------:|:------------------------------------:|:--------------------------------------:|:-----------------------------------:|:------------------------------------:|:----------------------------------:|:---------------------------------------------:|
| 09/09/20 |    Warren    | 74.8                                      | 4.1                              | 5                                    | 5.1                                    | 7.7                                 | 9                                    | 9.5                                | 3                                             |
| 14/09/20 | Philadelphia | 70                                        | 4.4                              | 5                                    | 6.5                                    | 8.5                                 | 10.4                                 | 10                                 | 5.5                                           |
| 21/09/20 |   Manitowoc  | 84.7                                      | 3.3                              | 5                                    | 3.6                                    | 6.3                                 | 7.6                                  | 8.2                                | 1.6                                           |
| 30/09/20 |  Greensburg  | 84.4                                      | 3.1                              | 5                                    | 3.5                                    | 6.2                                 | 7.4                                  | 8.1                                | 1.2                                           |

From this we can determine the averages for each of the scores and compare them:

| Candidate | Flesch-Kincaid Reading (Higher is easier) | New Dale Chall (Lower is easier) | Spache Readability (Lower is easier) | Flesch-Kincaid Grade (Lower is easier) | Gunning Fog Index (Lower is easier) | Coleman-Liau Index (Lower is easier) | SMOG Index Score (Lower is easier) | Automated Readability Index (Lower is easier) |
|-----------|:-----------------------------------------:|:--------------------------------:|:------------------------------------:|:--------------------------------------:|:-----------------------------------:|:------------------------------------:|:----------------------------------:|:---------------------------------------------:|
|   Trump   |           84.1                            |             3.3                  |             5.0                      |             4.0                        |             6.7                     |             7.2                      |             8.5                    |             2.0                               |
|   Biden   |           78.5                            |             3.7                  |             5.0                      |             4.7                        |             7.2                     |             8.6                      |             9.0                    |             2.8                               |

We can see that the readability of Trump's speeches is on average easier than those of Biden's speeches. This could be due to them attempting to appeal to different voters. It is worth noting that Biden's speeches tend to be short, at an average of 26 mins.

## The Change in Word Frequency Over Time

We can use the `word_frequency(df, c)` function, _where `df` is the data frame to apply to and `c` is a collection of words to check and plot
,_ to plot a graphical summary of the frequency of words over time from the speeches.

```{r word_frequency_over_time, warning=FALSE, message=FALSE, fig.width=10, fig.height=6, out.width="98%"}
word_frequency(trump_speeches, c("virus", "biden", "china", "president", "economy","jobs"))
```

The graphs show us the frequency of the words (y-axis) in each of the speeches (point on the graph) plotted over time (x-axis). A trend line is added to help identiy the usage of the words by Trump in his speeches. A horizontal line has been added to aid in seeing the percentage above zero for some words that are used very infrequently. 

In the graph above, it is interesting to note the following:

* Virus
  * that Trump rarely uses the word virus or in fact any word relating to the COVID pandemic. However, it is mentioned in each of the speeches in a very small amount
* Economy
  * Used only slightly more than the word virus but still not noticeable
* Jobs
  * Used less and less over the month in a downward trend

Based on these two words and their frequency in his speeches, it could be deemed that given the amount of bad press the Americans and Trump has received over the pandemic he is most likely trying to not make too big a deal of it. The estimated cost to the Americans of the virus has been estimated at $16 trillion according to Gandal (2020) of CBS news.

Looking at the following words:

* President
  * Used more frequently as the election day approaches
* Biden
  * Used less frequently as the election day approaches

We can see that there is an increase in the usage of president and decrease in the word Biden. This could be in relation to Trump wishing to downplay his competitor in the race for the presidency and associate himself with the word president.


One of the most commonly used words was America. This is due to each of the speeches finishing with the following phrases:

* make America wealthy again
* make America strong again
* make America proud again
* make America safe again
* make America great again

This can be seen reflected in the frequency graph below.

```{r word_frequency_over_time2, warning=FALSE, message=FALSE, fig.width=10, fig.height=6, out.width="98%"}
word_frequency(trump_speeches, c("america", "american"))
```


## Frequency of Words per Speech

We can use the `plot_tf_idf(df, n)` function, _where `df` is the data frame to apply to and `n` is the number of 'top' words to 
show,_ to plot a graphical summary of the most frequent words which occur in each speech. This function makes use of the **tf-idf 
index** which computes the frequency of a word, adjusted for how rarely it is used.

```{r frequency_of_words_per_speech, warning=FALSE, message=FALSE, fig.width=10, fig.height=18, out.width="98%"}
plot_tf_idf(trump_speeches, 10)
```

### Bemidji Rally Insights
'**Jason**' refers to Jason Lewis, a Republican who was running for Senate in September 2020 and has said that he _"won't distance himself from Presdient Donald Trump or his policies"_ while running for federal office.

'**Pulitzer**' refers to the _Pulitzer Prize_, an award for achievements in newspaper, magazine, and online journalism. Trump explains how he doesn't believe that organisations such as the New York Times and The Washington Post deserve the prizes they have been awarded.

### Fayetteville Rally
'**David**' and '**1.1**' refer to a $1.1 billion construction project involving David Friedman, an American economist and lawyer.

'**TikTok**': The speech contains two references to how Trump is _"very close"_ to a _"great deal"_ with Tik-Tok.

### Freeland Rally
'**Elite'**: Trump is referring to the audience; _"I think most of you are nod middle class. You're upper class"_.

'**Tariffs**' and '**200**': Tariffs with Japan and China for imported cars was one of the key points of discussion during this rally. Trump mentions that his administration has added _"over 200 new auto and auto parts plants"_.

### Henderson Rally
'**Colby**' and '**Justin**' refers to Colby Covington and Justin Gaethje; two mixed-martial artists.

'**Dana**' is a reference to Dana White: the president of the UFC.

'**Brandon**' refers to Brandon Judd, president of the National Border Patrol Council. Trump invites Brandon to pick out a fighter, so he can see _"whether he can take Colby in a fight"_.

### Latrobe Rally
'**Salon**' refers to a controversy involving Nancy Pelosi, the Speaker of the United States House of Representatives. She was seen in a hair salon without a mask; the hair salon in question was pressured into shutting down as a result of this controversy. A GoFundMe raise $300,000 for the owner.

### Minden
'**Rig**': Trump mentions how _"they"_ are trying to righ the election. _"[the govener] is in charge of the election and the millions of ballots...he can rig the election"_.

## Zipf's Law

```{r zipfs_law, warning=FALSE, message=FALSE, fig.width=10, fig.height=6, out.width="98%"}
zipfs_law(trump_speeches, 2)
zipfs_law(trump_speeches, 3)
```

## References

- Gandel, S (2020) Coronavirus pandemic to cost Americans $16 trillion, study finds. Available at: https://www.cbsnews.com/news/coronavirus-pandemic-cost-americans-16-trillion/ (Accessed: 12 January 2021)

- CNN Politics (2020) Presidential Results. Available at: https://edition.cnn.com/election/2020/results/president#mapmode=lead (Accessed: 12 January 2021)

- Rev (2020) Joe Biden Climate Change Speech Transcript in Wilmington, Delaware September 14. Available at: https://www.rev.com/blog/transcripts/joe-biden-climate-change-speech-transcript-september-14 (Accessed: 13 January 2021)

- Rev (2020) Joe Biden Campaign Speech Transcript Manitowoc, Wisconsin September 21. Available at: https://www.rev.com/blog/transcripts/joe-biden-campaign-speech-transcript-manitowoc-wisconsin-september-21 (Accessed: 13 January 2021)

- Rev (2020) Joe Biden Train Tour Campaign Speech Transcript Greensburg, PA September 30. Available at: https://www.rev.com/blog/transcripts/joe-biden-train-tour-campaign-speech-transcript-greensburg-pa-september-30 (Accessed: 13 January 2021)

- Rev (2020) Joe Biden Speech Transcript Warren, Michigan September 9. Available at: https://www.rev.com/blog/transcripts/joe-biden-speech-transcript-warren-michigan-september-9 (Accessed: 13 January 2021)
